{% extends 'ingest/wide.html' %}

{% block wide %}

<h1><b>Collection</b> {{ collection.name }} 
  {% if collection.locked %}<i class="fa fa-lock"></i>
  {% else %}<i class="fa fa-unlock"></i>
  {% endif %}
</h1>

<div class="list-group">
  <a href="#" class="list-group-item"><h4 class="list-group-item-heading">Description</h4> {{collection.description}}</a>
  <a href="#" class="list-group-item"><h4 class="list-group-item-heading">Organization</h4> {{collection.organization_name}}</a>
  <a href="#" class="list-group-item"><h4 class="list-group-item-heading">Lab</h4> {{collection.lab_name}}</a>
  <a href="#" class="list-group-item"><h4 class="list-group-item-heading">Project funder</h4> {{collection.project_funder}}</a>
  <a href="#" class="list-group-item"><h4 class="list-group-item-heading">Project funder ID</h4> {{collection.project_funder_id}}</a>
  <a href="{% url 'ingest:collection_data_path' pk=collection.pk %}" class="list-group-item"><h4 class="list-group-item-heading">Data staging area </h4> {{collection.data_path}} <i class="fa fa-link"></i></a>

  {% if collection.status == "NOT_SUBMITTED" %}
  <a href="{% url 'ingest:collection_validation_results' pk=collection.pk %}" class="list-group-item list-group-item-info"><h4 class="list-group-item-heading">Submission & Validation Status</h4> Not submitted or validated</a>
  {% elif collection.status == "PENDING" %}
  <a href="{% url 'ingest:collection_validation_results' pk=collection.pk %}" class="list-group-item list-group-item-warning"><h4 class="list-group-item-heading">Submission & Validation Status</h4> Submitted and validation pending</a>
  {% elif collection.status == "SUCCESS" %}
  <a href="{% url 'ingest:collection_validation_results' pk=collection.pk %}" class="list-group-item list-group-item-success"><h4 class="list-group-item-heading">Submission & Validation Status</h4> Submitted and validation successful</a>
  {% elif collection.status == "FAILED" %}
  <a href="{% url 'ingest:collection_validation_results' pk=collection.pk %}" class="list-group-item list-group-item-danger"><h4 class="list-group-item-heading">Submission & Validation Status</h4> Submitted and validation failed</a>
  {% endif %}

</div>
{% if image_metadata_queryset %}
  <div class="panel panel-default">
    <div class="panel-heading collapsed" data-toggle="collapse" data-target="#collapseOrderMetadata"> Metadata <i class="chevron fa fa-fw" ></i></div>
    <div class="collapse" id="collapseOrderMetadata">
      {% load render_table from django_tables2 %}
      {% render_table table %}
    </div>
  </div>

  {% if collection.locked %}
    <div class="alert alert-info">
      <strong>Submitted collections cannot be modified or deleted.</strong>
    </div>
  {% else %}
    <p>If you are done editing metadata and your data is finished uploading, hit submit at this time</p>
    <form action="" method="post">{% csrf_token %}
      <p>
        <input class="btn btn-primary" type="submit" value="Submit Collection" name="submit_collection" onclick="return confirm('If submission is successful, no further edits can be made. Are you sure?')"/>
      </p>
    </form>
    <form method="post" enctype="multipart/form-data">{% csrf_token %}
      <p>
        <input type="button" class="btn btn-primary" id="UploadMetadata" value="Upload Metadata" onclick="document.getElementById('file').click();" />
        <input type="file" style="display:none;" id="file" name="spreadsheet_file" onchange="form.submit()" />
      </p>
    </form>
    <p><a class="btn btn-primary" href="{% url 'ingest:collection_update' pk=collection.pk %}">Edit Collection</a></p>
    <p><a class="btn btn-danger" href="{% url 'ingest:collection_delete' pk=collection.pk %}">Delete Collection</a></p>
  {% endif %}
{% else %}
    <form method="post" enctype="multipart/form-data">{% csrf_token %}
      <p>
        <input type="button" class="btn btn-primary" id="UploadMetadata" value="Upload Metadata" onclick="document.getElementById('file').click();" />
        <input type="file" style="display:none;" id="file" name="spreadsheet_file" onchange="form.submit()" />
      </p>
    </form>
    <p><a class="btn btn-primary" href="{% url 'ingest:collection_update' pk=collection.pk %}">Edit Collection</a></p>
    <p><a class="btn btn-danger" href="{% url 'ingest:collection_delete' pk=collection.pk %}">Delete Collection</a></p>
  <div class="alert alert-info">
    <strong>This collection doesn't have any metadata yet.</strong>
  </div>
{% endif %}

<p>
<a href="{% url 'ingest:collection_list' %}">
  <button class="cancel btn btn-primary" value="ignore" formnovalidate="">Cancel</button>
</a>
</p>

{% endblock %}
