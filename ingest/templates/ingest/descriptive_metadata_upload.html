{% extends 'ingest/narrow.html' %}

{% load static %}

{% block narrow %}

{% if pi %}
<a href="{% url 'ingest:index' %}">
  <button class="cancel btn btn btn-primary" value="ignore" formnovalidate="">Return to PI Dashboard</button>
</a>
{% endif %}

<br>
<h1>Upload Metadata Spreadsheet</h1>
<p>Step 2 of 2: Upload metdata for associated submission</p>
{% if collections %}
<ul class="list-group">
  <li class="list-group-item">Download and fill out either the <a href="{% static 'ingest/BILNewMetadata.xlsx' %}">Excel</a> or <a href="{% static '/ingest/static/ingest/BILNewMetadata.ods' %}">LibreOffice Calc</a> template. </li>
  <li class="list-group-item">Choose a collection, then upload your metadata.</li>.
  <p> If the project you are looking for is not in this list, it must be added by the PI of your project. </p>
</ul>

  <hr>

  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form }}
    </br>

    </br>
    <input type="button" class="btn btn-lg btn-primary" id="UploadMetadata" value="Upload Metadata" onclick="document.getElementById('file').click();" />
    
    <button class="btn btn-primary" type="button" disabled>
      <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
      <span class="visually-hidden">Loading...</span>
    </button>

    <input type="file" style="display:none;" id="file" name="spreadsheet_file" onchange="form.submit();" />
    </br>
  </form>
{% else %}
  <div class="alert alert-info">
    <p>You need to create a submission before uploading a metadata spreadsheet</p>
  </div>
{% endif %}

</br>
<a href="{% url 'ingest:index' %}">
  <button class="cancel btn btn-lg btn-primary" value="ignore" formnovalidate="">Cancel</button>
</a>

{% endblock %}
